{% extends "layout.html" %}
{% block content %}

<h1 class="display-5 text-center mb-2">Sportstream</h1>
<p class="text-center text-muted mb-4">
  Explora los pr√≥ximos encuentros disponibles en <span class="brand">Kakarotfoot</span>.
</p>

<div class="row g-3 align-items-center justify-content-center mb-4">
  <div class="col-lg-6">
    <input id="searchInput" class="form-control form-control-lg input-dark"
      placeholder="Buscar por equipo, liga o evento...">
  </div>

  <div class="col-lg-3">
    <select id="leagueFilter" class="form-select form-select-lg input-dark">
      <option value="">Todas las ligas</option>
      {% for l in events | map(attribute='league') | unique %}
      {% if l %}
      <option value="{{ l }}">{{ l }}</option>
      {% endif %}
      {% endfor %}
    </select>
  </div>

  <div class="col-lg-2">
    <button id="refreshBtn" class="btn btn-primary btn-lg w-100">Refrescar datos</button>
  </div>
</div>

<div class="table-responsive shadow-sm rounded">
  <table id="eventsTable" class="table table-dark table-striped">
    <thead>
      <tr>
        <th>Fecha/Hora UTC</th>
        <th>Liga</th>
        <th>Partido</th>
        <th>Stream</th>
      </tr>
    </thead>

    <tbody>
      {% for event in events %}
      <tr data-league="{{ event.league }}">
        <td>{{ event.start_time | datetime }}</td>
        <td>{{ event.league }}</td>
        <td>{{ event.home }} vs {{ event.away }}</td>
        <td class="text-center">
          {% for s in event.streams %}
          <a class="btn btn-outline-primary btn-sm d-inline-flex align-items-center gap-2"
            href="/stream?url={{ s.url|urlencode }}&source={{ s.source|urlencode }}">
            {{ s.name }}
            {% if s.language %}
            <span class="badge text-bg-dark border">{{ s.language|upper }}</span>
            {% endif %}
          </a>
          {% endfor %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}